create database exp1;

use exp1;

create table college (college_code varchar(20) primary key, college_name varchar(20), address varchar(40));

create table faculty (college_code varchar(20), faculty_code varchar(20) primary key, name varchar(40), qualification varchar(30), experience int(3), department varchar(20), address varchar(40), foreign key(college_code) references college(college_code));

INSERT into college values("kte","rit","kottayam"),("pkd","gec palakkad","sreekrishnapuram"),("idk","gec idukki","painavu"),("tvm","cet","trivandrum"),("tkm","tkmce","kollam");

INSERT into faculty values("kte","1105","felvin","btech",3,"cse","kottayam"), ("idk","4512","jose","mtech",14,"ec","kochi"),("idk","2287","anne","btech",7,"cs","kollam"),("idk","4775","sarun","mtech",6,"eee","idukki"),("kte","2273","nikhil","mtech",8,"cs","alappey"),("pkd","1462","abin","btech",2,"mtech","ernakulam"),('kte','3019','sai','btech',11,'civil','thrissur'),('idk','4012','kiran','btech',12,'ec','kannur');

a)
select * from faculty where college_code='idk' and experience>=10;

b)
select * from faculty where experience>=10 and qualification!='mtech';

c)
select * from faculty where college_code='idk' order by department,experience asc;

d)
select c.college_code,c.college_name,count(f.faculty_code) as faculty_count from college c join faculty f on c.college_code=f.college_code group by c.college_code,c.college_name having count(f.faculty_code)>1;

e)
(select c.college_code,c.college_name,count(*) as fac_count,'minimum' as status from college c,faculty f where c.college_code=f.college_code group by c.college_code,c.college_name order by count(*) asc limit 1) union (select c.college_code,c.college_name,count(*) as fac_count,'maximum' as status from college c,faculty f where c.college_code=f.college_code group by c.college_code,c.college_name order by count(*) desc limit 1);


To create view
create view faculty_count as select c.college_name,count(*) as fac_count from college c,faculty f where c.college_code=f.college_code group by c.college_name;

select * from faculty_count;
